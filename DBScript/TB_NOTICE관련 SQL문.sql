-- 공지 게시판

  

-- 1. 공지사항 테이블

CREATE TABLE TB_NOTICE(
	BOARD_NO NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	CATEGORY_ID VARCHAR2(5) NOT NULL,
	MEMBER_NO NUMBER NOT NULL,
	BOARD_TITLE VARCHAR2(100) NOT NULL,
	BOARD_CONTENT VARCHAR2(4000) NOT NULL,
	CREATED_DATE DATE DEFAULT SYSDATE NOT NULL,
	MODIFIED_DATE DATE,
	IS_DELETED CHAR(1) DEFAULT 'N' CHECK(IS_DELETED IN('N','Y')) NOT NULL,
	VIEW_COUNT NUMBER DEFAULT 0 NOT NULL,
	CONSTRAINT FK_TB_NOTICE_TYPE FOREIGN KEY(CATEGORY_ID)
	REFERENCES TB_NOTICE_CATEGORY(CATEGORY_ID) ON DELETE CASCADE,
	CONSTRAINT FK_TB_NOTICE_MEMBER FOREIGN KEY(MEMBER_NO)
	REFERENCES TB_MEMBER(MEMBER_NO) ON DELETE SET NULL
);

DROP TABLE TB_NOTICE;
SELECT * FROM TB_NOTICE;

-- 2. 공지사항 첨부파일

CREATE TABLE TB_NOTICE_ATTACHMENT_IMG(
	NOTICE_ATTACHMENT_NO NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	BOARD_NO NUMBER NOT NULL,
	ATTACHMENT_ITEM VARCHAR2(300),
	CONSTRAINT FK_TB_NOTICE_ATTACHMENT_NOTICE FOREIGN KEY(BOARD_NO)
	REFERENCES TB_NOTICE(BOARD_NO) ON DELETE CASCADE
);

DROP TABLE TB_NOTICE_ATTACHMENT_IMG;

-- 3. 공지사항 카테고리

CREATE TABLE TB_NOTICE_CATEGORY(
	CATEGORY_ID VARCHAR2(5) PRIMARY KEY NOT NULL,
	CATEGORY_NAME VARCHAR2(20) NOT NULL
);

INSERT INTO TB_NOTICE_CATEGORY VALUES ('N0001', 'common');
INSERT INTO TB_NOTICE_CATEGORY VALUES ('N0002', 'update');
INSERT INTO TB_NOTICE_CATEGORY VALUES ('N0003', 'bugFix');

DROP TABLE TB_NOTICE_TYPE;


SELECT * FROM TB_NOTICE_TYPE;

SELECT * FROM TB_NOTICE_ATTACHMENT_IMG;
-- 4. 공지사항 관련 트리거

  

  