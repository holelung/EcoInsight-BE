-- 신고 카테고리 테이블
CREATE TABLE TB_REPORT_CATEGORY (
  REPORT_CATEGORY_ID   VARCHAR2(5)    PRIMARY KEY,
  REPORT_CATEGORY_NAME VARCHAR2(100)  NOT NULL
);


-- 2) 커뮤니티 게시판 신고
CREATE TABLE TB_COMMUNITY_REPORT (
  REPORT_NO           NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY, 
  REPORTER            NUMBER                 NOT NULL, 
  BOARD_NO          NUMBER                 NOT NULL, 
  REPORT_CATEGORY_ID  VARCHAR2(5)            NOT NULL, 
  REPORT_CONTENT      VARCHAR2(1000), 
  CONSTRAINT FK_COMMUNITY_REPORT_MEMBER
    FOREIGN KEY (REPORTER)
    REFERENCES TB_MEMBER       (MEMBER_NO),

  CONSTRAINT FK_COMMUNITY_REPORT_BOARD
    FOREIGN KEY (BOARD_NO)
    REFERENCES TB_COMMUNITY_BOARD (BOARD_NO),

  CONSTRAINT FK_COMMUNITY_REPORT_CATEGORY
    FOREIGN KEY (REPORT_CATEGORY_ID)
    REFERENCES TB_REPORT_CATEGORY (REPORT_CATEGORY_ID)
);

-- 인증게시판 신고

CREATE TABLE TB_AUTH_BOARD_REPORT (
  REPORT_NO           NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY, 
  REPORTER            NUMBER                 NOT NULL, 
  BOARD_NO       NUMBER                 NOT NULL, 
  REPORT_CATEGORY_ID  VARCHAR2(5)            NOT NULL, 
  REPORT_CONTENT      VARCHAR2(1000), 

  CONSTRAINT FK_AUTHBOARD_REPORT_MEMBER
    FOREIGN KEY (REPORTER)
    REFERENCES TB_MEMBER       (MEMBER_NO),

  CONSTRAINT FK_AUTHBOARD_REPORT_BOARD
    FOREIGN KEY (BOARD_NO)
    REFERENCES TB_AUTH_BOARD   (AUTH_BOARD_NO),

  CONSTRAINT FK_AUTHBOARD_REPORT_CATEGORY
    FOREIGN KEY (REPORT_CATEGORY_ID)
    REFERENCES TB_REPORT_CATEGORY (REPORT_CATEGORY_ID)
);


-- 커뮤니티 댓글 신고

CREATE TABLE TB_COMMUNITY_COMMENT_REPORT (
  COMMENT_REPORT_NO       NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY, 
  REPORT_CATEGORY_ID  VARCHAR2(5)            NOT NULL, 
  REPORTER            NUMBER                 NOT NULL,
  COMMENT_NO          NUMBER                 NOT NULL,
  COMMENT_REPORT_CONTENT  VARCHAR2(1000),

  CONSTRAINT FK_COMMUNITY_COMMENT_REPORT_MEMBER
    FOREIGN KEY (REPORTER)
    REFERENCES TB_MEMBER       (MEMBER_NO),

  CONSTRAINT FK_COMMUNITY_COMMENT_REPORT_CATEGORY
    FOREIGN KEY (REPORT_CATEGORY_ID)
    REFERENCES TB_REPORT_CATEGORY (REPORT_CATEGORY_ID)
);

-- 인증게시판 댓글 신고

CREATE TABLE TB_AUTH_BOARD_COMMENT_REPORT (
  COMMENT_REPORT_NO       NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY, 
  REPORT_CATEGORY_ID  VARCHAR2(5)            NOT NULL, 
  REPORTER            NUMBER                 NOT NULL,
  COMMENT_NO          NUMBER                 NOT NULL,
  COMMENT_REPORT_CONTENT  VARCHAR2(1000), 

  CONSTRAINT FK_AUTHBOARD_COMMENT_REPORT_MEMBER
    FOREIGN KEY (REPORTER)
    REFERENCES TB_MEMBER       (MEMBER_NO),

  CONSTRAINT FK_AUTHBOARD_COMMENT_REPORT_CATEGORY
    FOREIGN KEY (REPORT_CATEGORY_ID)
    REFERENCES TB_REPORT_CATEGORY (REPORT_CATEGORY_ID)
);


-- 멤버테이블 주민등록번호 컬럼 삭제
ALTER TABLE TB_MEMBER DROP COLUMN MEMBER_SSN;
SELECT * FROM TB_COMMUNITY_RECOMMEND;



ALTER TABLE TB_COMMUNITY_RECOMMEND RENAME COLUMN C_BOARD_NO TO BOARD_NO;


COMMIT;





------------------ 수정사항있으면 과감하게 DROP 해주세요 ---------------------------------
